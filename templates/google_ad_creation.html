<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Google Ad - {{ client.client_name }} - WeTechForU AI Marketing Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .ad-preview {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            background-color: #f8f9fa;
            margin-top: 20px;
        }
        .ad-preview h4 {
            color: #1a73e8;
            font-size: 18px;
            margin-bottom: 5px;
        }
        .ad-preview .url {
            color: #006621;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .ad-preview .description {
            color: #545454;
            font-size: 14px;
            line-height: 1.4;
        }
        .budget-input {
            max-width: 200px;
        }
        .keyword-tag {
            display: inline-block;
            background-color: #e3f2fd;
            color: #1976d2;
            padding: 4px 8px;
            border-radius: 4px;
            margin: 2px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/">
                                <i class="fas fa-tachometer-alt"></i> Admin Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/clients">
                                <i class="fas fa-users"></i> Client Management
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/client/{{ client.id }}">
                                <i class="fas fa-arrow-left"></i> Back to {{ client.client_name }}
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/logout">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="fab fa-google text-primary"></i> Create Google Ad
                        <small class="text-muted">for {{ client.client_name }}</small>
                    </h1>
                </div>

                <div class="row">
                    <!-- Ad Creation Form -->
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-plus-circle"></i> Ad Campaign Setup
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="googleAdForm">
                                    <!-- Campaign Information -->
                                    <div class="mb-4">
                                        <h6 class="text-primary">Campaign Information</h6>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label for="campaignName" class="form-label">Campaign Name</label>
                                                <input type="text" class="form-control" id="campaignName" 
                                                       value="{{ client.client_name }} - Marketing Campaign" required>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="campaignType" class="form-label">Campaign Type</label>
                                                <select class="form-select" id="campaignType" required>
                                                    <option value="search">Search Campaign</option>
                                                    <option value="display">Display Campaign</option>
                                                    <option value="shopping">Shopping Campaign</option>
                                                    <option value="video">Video Campaign</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Ad Content -->
                                    <div class="mb-4">
                                        <h6 class="text-primary">Ad Content</h6>
                                        <div class="mb-3">
                                            <label for="headline1" class="form-label">Headline 1</label>
                                            <input type="text" class="form-control" id="headline1" 
                                                   maxlength="30" placeholder="Enter headline (max 30 characters)" required>
                                            <div class="form-text">30 characters max</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="headline2" class="form-label">Headline 2</label>
                                            <input type="text" class="form-control" id="headline2" 
                                                   maxlength="30" placeholder="Enter second headline (max 30 characters)">
                                            <div class="form-text">30 characters max</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="headline3" class="form-label">Headline 3</label>
                                            <input type="text" class="form-control" id="headline3" 
                                                   maxlength="30" placeholder="Enter third headline (max 30 characters)">
                                            <div class="form-text">30 characters max</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="description1" class="form-label">Description 1</label>
                                            <textarea class="form-control" id="description1" rows="2" 
                                                      maxlength="90" placeholder="Enter description (max 90 characters)" required></textarea>
                                            <div class="form-text">90 characters max</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="description2" class="form-label">Description 2</label>
                                            <textarea class="form-control" id="description2" rows="2" 
                                                      maxlength="90" placeholder="Enter second description (max 90 characters)"></textarea>
                                            <div class="form-text">90 characters max</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="finalUrl" class="form-label">Final URL</label>
                                            <input type="url" class="form-control" id="finalUrl" 
                                                   value="{{ client.website }}" placeholder="https://example.com" required>
                                        </div>
                                    </div>

                                    <!-- Keywords -->
                                    <div class="mb-4">
                                        <h6 class="text-primary">Keywords</h6>
                                        <div class="mb-3">
                                            <label for="keywords" class="form-label">Target Keywords</label>
                                            <textarea class="form-control" id="keywords" rows="3" 
                                                      placeholder="Enter keywords separated by commas (e.g., marketing services, digital marketing, SEO)"></textarea>
                                            <div class="form-text">Separate keywords with commas</div>
                                        </div>
                                        <div id="keywordTags" class="mb-3"></div>
                                    </div>

                                    <!-- Budget & Bidding -->
                                    <div class="mb-4">
                                        <h6 class="text-primary">Budget & Bidding</h6>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <label for="dailyBudget" class="form-label">Daily Budget</label>
                                                <div class="input-group">
                                                    <span class="input-group-text">$</span>
                                                    <input type="number" class="form-control budget-input" id="dailyBudget" 
                                                           min="1" step="0.01" value="10.00" required>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <label for="bidStrategy" class="form-label">Bid Strategy</label>
                                                <select class="form-select" id="bidStrategy">
                                                    <option value="target_cpa">Target CPA</option>
                                                    <option value="target_roas">Target ROAS</option>
                                                    <option value="maximize_clicks">Maximize Clicks</option>
                                                    <option value="maximize_conversions">Maximize Conversions</option>
                                                </select>
                                            </div>
                                            <div class="col-md-4">
                                                <label for="targetCpa" class="form-label">Target CPA</label>
                                                <div class="input-group">
                                                    <span class="input-group-text">$</span>
                                                    <input type="number" class="form-control budget-input" id="targetCpa" 
                                                           min="0.01" step="0.01" value="5.00">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Targeting -->
                                    <div class="mb-4">
                                        <h6 class="text-primary">Targeting</h6>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label for="location" class="form-label">Location</label>
                                                <input type="text" class="form-control" id="location" 
                                                       placeholder="e.g., United States, New York" value="United States">
                                            </div>
                                            <div class="col-md-6">
                                                <label for="language" class="form-label">Language</label>
                                                <select class="form-select" id="language">
                                                    <option value="en">English</option>
                                                    <option value="es">Spanish</option>
                                                    <option value="fr">French</option>
                                                    <option value="de">German</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- AI Content Generation -->
                                    <div class="mb-4">
                                        <h6 class="text-primary">AI Content Generation</h6>
                                        <div class="alert alert-info">
                                            <i class="fas fa-robot"></i> Use AI to generate compelling ad content based on your business
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label for="businessType" class="form-label">Business Type</label>
                                                <select class="form-select" id="businessType">
                                                    <option value="technology">Technology</option>
                                                    <option value="healthcare">Healthcare</option>
                                                    <option value="retail">Retail</option>
                                                    <option value="services">Professional Services</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="adGoal" class="form-label">Ad Goal</label>
                                                <select class="form-select" id="adGoal">
                                                    <option value="awareness">Brand Awareness</option>
                                                    <option value="leads">Generate Leads</option>
                                                    <option value="sales">Drive Sales</option>
                                                    <option value="traffic">Website Traffic</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <button type="button" class="btn btn-outline-primary" onclick="generateAdContent()">
                                                <i class="fas fa-magic"></i> Generate Ad Content with AI
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Action Buttons -->
                                    <div class="d-flex gap-2">
                                        <button type="button" class="btn btn-primary" onclick="createGoogleAd()">
                                            <i class="fab fa-google"></i> Create Google Ad
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="saveDraft()">
                                            <i class="fas fa-save"></i> Save Draft
                                        </button>
                                        <button type="button" class="btn btn-outline-info" onclick="previewAd()">
                                            <i class="fas fa-eye"></i> Preview Ad
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Ad Preview -->
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-eye"></i> Ad Preview
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="ad-preview">
                                    <h4 id="previewHeadline1">Your Headline 1</h4>
                                    <div class="url" id="previewUrl">{{ client.website }}</div>
                                    <div class="description" id="previewDescription1">Your description will appear here</div>
                                </div>
                                
                                <div class="mt-3">
                                    <h6>Campaign Summary</h6>
                                    <ul class="list-unstyled">
                                        <li><strong>Type:</strong> <span id="previewType">Search Campaign</span></li>
                                        <li><strong>Daily Budget:</strong> $<span id="previewBudget">10.00</span></li>
                                        <li><strong>Bid Strategy:</strong> <span id="previewBid">Target CPA</span></li>
                                        <li><strong>Location:</strong> <span id="previewLocation">United States</span></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Update preview as user types
        document.getElementById('headline1').addEventListener('input', function() {
            document.getElementById('previewHeadline1').textContent = this.value || 'Your Headline 1';
        });

        document.getElementById('description1').addEventListener('input', function() {
            document.getElementById('previewDescription1').textContent = this.value || 'Your description will appear here';
        });

        document.getElementById('finalUrl').addEventListener('input', function() {
            document.getElementById('previewUrl').textContent = this.value || '{{ client.website }}';
        });

        document.getElementById('campaignType').addEventListener('change', function() {
            document.getElementById('previewType').textContent = this.options[this.selectedIndex].text;
        });

        document.getElementById('dailyBudget').addEventListener('input', function() {
            document.getElementById('previewBudget').textContent = this.value;
        });

        document.getElementById('bidStrategy').addEventListener('change', function() {
            document.getElementById('previewBid').textContent = this.options[this.selectedIndex].text;
        });

        document.getElementById('location').addEventListener('input', function() {
            document.getElementById('previewLocation').textContent = this.value || 'United States';
        });

        // Keyword tags
        document.getElementById('keywords').addEventListener('input', function() {
            const keywords = this.value.split(',').map(k => k.trim()).filter(k => k);
            const tagsContainer = document.getElementById('keywordTags');
            tagsContainer.innerHTML = '';
            keywords.forEach(keyword => {
                const tag = document.createElement('span');
                tag.className = 'keyword-tag';
                tag.textContent = keyword;
                tagsContainer.appendChild(tag);
            });
        });

        function generateAdContent() {
            const businessType = document.getElementById('businessType').value;
            const adGoal = document.getElementById('adGoal').value;
            const clientName = '{{ client.client_name }}';
            
            // Show loading
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
            button.disabled = true;
            
            // Generate content based on business type and goal
            let headlines = [];
            let descriptions = [];
            
            if (businessType === 'technology') {
                if (adGoal === 'leads') {
                    headlines = [
                        'Transform Your Business with AI',
                        'Digital Solutions That Work',
                        'Tech Innovation for Growth'
                    ];
                    descriptions = [
                        'Get more leads with our cutting-edge technology solutions. Free consultation available.',
                        'Boost your business performance with our proven digital strategies. Start today!'
                    ];
                } else if (adGoal === 'awareness') {
                    headlines = [
                        'Leading Tech Solutions',
                        'Innovation Meets Results',
                        'Future-Ready Technology'
                    ];
                    descriptions = [
                        'Discover how our technology solutions can transform your business operations.',
                        'Join thousands of businesses already using our innovative tech solutions.'
                    ];
                }
            } else if (businessType === 'healthcare') {
                if (adGoal === 'leads') {
                    headlines = [
                        'Expert Healthcare Services',
                        'Quality Care You Trust',
                        'Your Health, Our Priority'
                    ];
                    descriptions = [
                        'Get the healthcare you deserve. Schedule your appointment today.',
                        'Professional medical care with a personal touch. Book now!'
                    ];
                }
            }
            
            // Fill in the form
            if (headlines.length > 0) {
                document.getElementById('headline1').value = headlines[0];
                document.getElementById('headline2').value = headlines[1] || '';
                document.getElementById('headline3').value = headlines[2] || '';
            }
            
            if (descriptions.length > 0) {
                document.getElementById('description1').value = descriptions[0];
                document.getElementById('description2').value = descriptions[1] || '';
            }
            
            // Update preview
            document.getElementById('previewHeadline1').textContent = headlines[0] || 'Your Headline 1';
            document.getElementById('previewDescription1').textContent = descriptions[0] || 'Your description will appear here';
            
            // Reset button
            setTimeout(() => {
                button.innerHTML = originalText;
                button.disabled = false;
            }, 1000);
        }

        function createGoogleAd() {
            const formData = {
                client_id: {{ client.id }},
                campaign_name: document.getElementById('campaignName').value,
                campaign_type: document.getElementById('campaignType').value,
                headline1: document.getElementById('headline1').value,
                headline2: document.getElementById('headline2').value,
                headline3: document.getElementById('headline3').value,
                description1: document.getElementById('description1').value,
                description2: document.getElementById('description2').value,
                final_url: document.getElementById('finalUrl').value,
                keywords: document.getElementById('keywords').value,
                daily_budget: document.getElementById('dailyBudget').value,
                bid_strategy: document.getElementById('bidStrategy').value,
                target_cpa: document.getElementById('targetCpa').value,
                location: document.getElementById('location').value,
                language: document.getElementById('language').value
            };
            
            // Show loading
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating...';
            button.disabled = true;
            
            fetch('/api/google-ads/create', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Google Ad created successfully!');
                    // Redirect back to client management
                    window.location.href = '/admin/client/{{ client.id }}';
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                alert('Error creating Google Ad: ' + error);
            })
            .finally(() => {
                button.innerHTML = originalText;
                button.disabled = false;
            });
        }

        function saveDraft() {
            alert('Draft saved! (This would save the ad as a draft in a real implementation)');
        }

        function previewAd() {
            alert('Ad preview updated! Check the preview panel on the right.');
        }
    </script>
</body>
</html>
