<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeTechForU - Client Onboarding</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .onboarding-step {
            display: none;
        }
        .onboarding-step.active {
            display: block;
        }
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }
        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            font-weight: bold;
        }
        .step.active {
            background: #007bff;
            color: white;
        }
        .step.completed {
            background: #28a745;
            color: white;
        }
        .business-type-card {
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #e9ecef;
        }
        .business-type-card:hover {
            border-color: #007bff;
            transform: translateY(-2px);
        }
        .business-type-card.selected {
            border-color: #007bff;
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 bg-dark text-white p-4">
                <h4><i class="fas fa-store"></i> WeTechForU Marketplace</h4>
                <p class="text-muted">Marketing Platform for Multiple Businesses</p>
                
                <div class="mt-4">
                    <h6>Platform Features:</h6>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-check text-success"></i> Multi-Client Management</li>
                        <li><i class="fas fa-check text-success"></i> Facebook Marketing</li>
                        <li><i class="fas fa-check text-success"></i> Google Ads</li>
                        <li><i class="fas fa-check text-success"></i> SEO Optimization</li>
                        <li><i class="fas fa-check text-success"></i> Email Campaigns</li>
                        <li><i class="fas fa-check text-success"></i> Analytics Dashboard</li>
                    </ul>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 p-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Add New Business Client</h2>
                    <a href="/admin/client-management" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Client Management
                    </a>
                </div>

                <!-- Step Indicator -->
                <div class="step-indicator">
                    <div class="step active" id="step-1">1</div>
                    <div class="step" id="step-2">2</div>
                    <div class="step" id="step-3">3</div>
                    <div class="step" id="step-4">4</div>
                    <div class="step" id="step-5">5</div>
                </div>

                <!-- Step 1: Business Information -->
                <div class="onboarding-step active" id="step1">
                    <h4>Step 1: Business Information</h4>
                    <form id="businessInfoForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="businessName" class="form-label">Business Name *</label>
                                    <input type="text" class="form-control" id="businessName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="businessType" class="form-label">Business Type *</label>
                                    <select class="form-select" id="businessType" required>
                                        <option value="">Select Business Type</option>
                                        <option value="healthcare">Healthcare/Medical</option>
                                        <option value="technology">Technology</option>
                                        <option value="retail">Retail/E-commerce</option>
                                        <option value="restaurant">Restaurant/Food</option>
                                        <option value="fitness">Fitness/Wellness</option>
                                        <option value="beauty">Beauty/Spa</option>
                                        <option value="legal">Legal Services</option>
                                        <option value="real_estate">Real Estate</option>
                                        <option value="education">Education</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="website" class="form-label">Website URL</label>
                                    <input type="url" class="form-control" id="website" placeholder="https://example.com">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="contactName" class="form-label">Contact Person *</label>
                                    <input type="text" class="form-control" id="contactName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email Address *</label>
                                    <input type="email" class="form-control" id="email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="phone" class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" id="phone">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="businessDescription" class="form-label">Business Description</label>
                            <textarea class="form-control" id="businessDescription" rows="3" placeholder="Describe what the business does..."></textarea>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="nextStep(2)">Next Step</button>
                    </form>
                </div>

                <!-- Step 2: Marketing Goals -->
                <div class="onboarding-step" id="step2">
                    <h4>Step 2: Marketing Goals & Budget</h4>
                    <form id="marketingGoalsForm">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Primary Marketing Goals:</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="goal-leads" value="leads">
                                    <label class="form-check-label" for="goal-leads">Generate More Leads</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="goal-awareness" value="awareness">
                                    <label class="form-check-label" for="goal-awareness">Increase Brand Awareness</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="goal-sales" value="sales">
                                    <label class="form-check-label" for="goal-sales">Drive Sales</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="goal-seo" value="seo">
                                    <label class="form-check-label" for="goal-seo">Improve SEO Rankings</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Marketing Budget (Monthly):</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="budget" id="budget-500" value="500">
                                    <label class="form-check-label" for="budget-500">$500 - $1,000</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="budget" id="budget-1000" value="1000">
                                    <label class="form-check-label" for="budget-1000">$1,000 - $2,500</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="budget" id="budget-2500" value="2500">
                                    <label class="form-check-label" for="budget-2500">$2,500 - $5,000</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="budget" id="budget-5000" value="5000">
                                    <label class="form-check-label" for="budget-5000">$5,000+</label>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <h6>Target Audience:</h6>
                            <textarea class="form-control" id="targetAudience" rows="3" placeholder="Describe the ideal customer..."></textarea>
                        </div>
                        <div class="mt-3">
                            <button type="button" class="btn btn-secondary" onclick="prevStep(1)">Previous</button>
                            <button type="button" class="btn btn-primary" onclick="nextStep(3)">Next Step</button>
                        </div>
                    </form>
                </div>

                <!-- Step 3: Platform Access -->
                <div class="onboarding-step" id="step3">
                    <h4>Step 3: Platform Access Setup</h4>
                    <form id="platformAccessForm">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Social Media Platforms:</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="platform-facebook" value="facebook">
                                    <label class="form-check-label" for="platform-facebook">
                                        <i class="fab fa-facebook text-primary"></i> Facebook Page
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="platform-instagram" value="instagram">
                                    <label class="form-check-label" for="platform-instagram">
                                        <i class="fab fa-instagram text-danger"></i> Instagram
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="platform-google" value="google">
                                    <label class="form-check-label" for="platform-google">
                                        <i class="fab fa-google text-success"></i> Google My Business
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Advertising Platforms:</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="ads-facebook" value="facebook_ads">
                                    <label class="form-check-label" for="ads-facebook">Facebook Ads</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="ads-google" value="google_ads">
                                    <label class="form-check-label" for="ads-google">Google Ads</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="ads-email" value="email_marketing">
                                    <label class="form-check-label" for="ads-email">Email Marketing</label>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <h6>Access Information:</h6>
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i>
                                <strong>Note:</strong> We'll send you instructions to grant access to your platforms. 
                                You can provide access later if not available now.
                            </div>
                        </div>
                        <div class="mt-3">
                            <button type="button" class="btn btn-secondary" onclick="prevStep(2)">Previous</button>
                            <button type="button" class="btn btn-primary" onclick="nextStep(4)">Next Step</button>
                        </div>
                    </form>
                </div>

                <!-- Step 4: Subscription Plan -->
                <div class="onboarding-step" id="step4">
                    <h4>Step 4: Choose Subscription Plan</h4>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card business-type-card" onclick="selectPlan('basic')">
                                <div class="card-body text-center">
                                    <h5 class="card-title">Basic Plan</h5>
                                    <h3 class="text-primary">$299/month</h3>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-check text-success"></i> 1 Platform Management</li>
                                        <li><i class="fas fa-check text-success"></i> 10 Posts/Month</li>
                                        <li><i class="fas fa-check text-success"></i> Basic Analytics</li>
                                        <li><i class="fas fa-check text-success"></i> Email Support</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card business-type-card" onclick="selectPlan('professional')">
                                <div class="card-body text-center">
                                    <h5 class="card-title">Professional Plan</h5>
                                    <h3 class="text-primary">$599/month</h3>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-check text-success"></i> 3 Platform Management</li>
                                        <li><i class="fas fa-check text-success"></i> 30 Posts/Month</li>
                                        <li><i class="fas fa-check text-success"></i> Advanced Analytics</li>
                                        <li><i class="fas fa-check text-success"></i> Priority Support</li>
                                        <li><i class="fas fa-check text-success"></i> SEO Optimization</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card business-type-card" onclick="selectPlan('enterprise')">
                                <div class="card-body text-center">
                                    <h5 class="card-title">Enterprise Plan</h5>
                                    <h3 class="text-primary">$999/month</h3>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-check text-success"></i> Unlimited Platforms</li>
                                        <li><i class="fas fa-check text-success"></i> Unlimited Posts</li>
                                        <li><i class="fas fa-check text-success"></i> Full Analytics Suite</li>
                                        <li><i class="fas fa-check text-success"></i> Dedicated Manager</li>
                                        <li><i class="fas fa-check text-success"></i> Custom Campaigns</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(3)">Previous</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(5)">Next Step</button>
                    </div>
                </div>

                <!-- Step 5: Review & Create -->
                <div class="onboarding-step" id="step5">
                    <h4>Step 5: Review & Create Client</h4>
                    <div class="card">
                        <div class="card-body">
                            <h6>Business Information:</h6>
                            <p id="review-business-name"></p>
                            <p id="review-business-type"></p>
                            <p id="review-contact"></p>
                            
                            <h6 class="mt-3">Marketing Goals:</h6>
                            <p id="review-goals"></p>
                            <p id="review-budget"></p>
                            
                            <h6 class="mt-3">Selected Plan:</h6>
                            <p id="review-plan"></p>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(4)">Previous</button>
                        <button type="button" class="btn btn-success" onclick="createClient()">
                            <i class="fas fa-plus"></i> Create Client Account
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentStep = 1;
        let selectedPlan = '';

        function nextStep(step) {
            if (validateCurrentStep()) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step-${currentStep}`).classList.remove('active');
                
                currentStep = step;
                
                document.getElementById(`step${currentStep}`).classList.add('active');
                document.getElementById(`step-${currentStep}`).classList.add('active');
                
                if (currentStep === 5) {
                    updateReview();
                }
            }
        }

        function prevStep(step) {
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            
            currentStep = step;
            
            document.getElementById(`step${currentStep}`).classList.add('active');
            document.getElementById(`step-${currentStep}`).classList.add('active');
        }

        function validateCurrentStep() {
            if (currentStep === 1) {
                const businessName = document.getElementById('businessName').value;
                const businessType = document.getElementById('businessType').value;
                const contactName = document.getElementById('contactName').value;
                const email = document.getElementById('email').value;
                
                if (!businessName || !businessType || !contactName || !email) {
                    alert('Please fill in all required fields.');
                    return false;
                }
            }
            return true;
        }

        function selectPlan(plan) {
            selectedPlan = plan;
            document.querySelectorAll('.business-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function updateReview() {
            document.getElementById('review-business-name').textContent = 
                `Business: ${document.getElementById('businessName').value}`;
            document.getElementById('review-business-type').textContent = 
                `Type: ${document.getElementById('businessType').value}`;
            document.getElementById('review-contact').textContent = 
                `Contact: ${document.getElementById('contactName').value} (${document.getElementById('email').value})`;
            
            const goals = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
            document.getElementById('review-goals').textContent = `Goals: ${goals.join(', ')}`;
            
            const budget = document.querySelector('input[name="budget"]:checked');
            document.getElementById('review-budget').textContent = 
                `Budget: $${budget ? budget.value : 'Not selected'}`;
            
            document.getElementById('review-plan').textContent = 
                `Plan: ${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)}`;
        }

        function createClient() {
            const formData = {
                business_name: document.getElementById('businessName').value,
                business_type: document.getElementById('businessType').value,
                website: document.getElementById('website').value,
                contact_name: document.getElementById('contactName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                business_description: document.getElementById('businessDescription').value,
                goals: Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value),
                budget: document.querySelector('input[name="budget"]:checked')?.value,
                target_audience: document.getElementById('targetAudience').value,
                platforms: Array.from(document.querySelectorAll('#platformAccessForm input[type="checkbox"]:checked')).map(cb => cb.value),
                advertising: Array.from(document.querySelectorAll('#platformAccessForm input[type="checkbox"]:checked')).map(cb => cb.value),
                plan: selectedPlan
            };

            fetch('/api/marketplace/clients/create', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Client created successfully!');
                    window.location.href = '/admin/client-management';
                } else {
                    alert('Error creating client: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error creating client. Please try again.');
            });
        }
    </script>
</body>
</html>
