<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO & Backlink Manager - WeTechForU</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .sidebar {
            background: linear-gradient(180deg, #dc3545 0%, #fd7e14 100%);
            min-height: 100vh;
        }
        .nav-link {
            color: #ffffff;
            transition: all 0.3s;
        }
        .nav-link:hover {
            color: #f8f9fa;
            background-color: rgba(255, 255, 255, 0.1);
        }
        .seo-card {
            border: 2px solid #28a745;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.2);
        }
        .seo-header {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border-top-left-radius: 13px;
            border-top-right-radius: 13px;
        }
        .backlink-opportunity {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        .difficulty-easy { border-left-color: #28a745; }
        .difficulty-medium { border-left-color: #ffc107; }
        .difficulty-hard { border-left-color: #dc3545; }
        .domain-analysis {
            background: linear-gradient(135deg, #007bff 0%, #6610f2 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .strategy-phase {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid #bbdefb;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container-fluid">
        <div class="row">
            <!-- Admin Sidebar -->
            <nav class="col-md-2 d-none d-md-block sidebar">
                <div class="sidebar-sticky p-3">
                    <h4 class="text-white mb-4">
                        <i class="fas fa-shield-alt"></i> Admin Portal
                    </h4>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="/admin">
                                <i class="fas fa-tachometer-alt"></i> Admin Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/clients">
                                <i class="fas fa-users"></i> Client Management
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/leads">
                                <i class="fas fa-user-plus"></i> Lead Management
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/lead-finder">
                                <i class="fas fa-search"></i> Lead Finder
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/subscription/plans">
                                <i class="fas fa-credit-card"></i> Subscription Plans
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/api-settings">
                                <i class="fas fa-plug"></i> API Settings
                            </a>
                        </li>
                        <li class="nav-item mt-3">
                            <a class="nav-link" href="/customer">
                                <i class="fas fa-user"></i> Customer View
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-warning" href="/logout">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main content -->
            <main class="col-md-10 ml-sm-auto px-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <div>
                        <h1 class="h2">
                            <i class="fas fa-search-plus text-success me-2"></i>
                            SEO & Backlink Manager
                        </h1>
                        <p class="text-muted">
                            Analyze domains, build backlinks, and improve SEO performance
                        </p>
                    </div>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <a href="/admin" class="btn btn-outline-primary me-2">
                            <i class="fas fa-arrow-left me-2"></i>Back to Admin
                        </a>
                        <a href="/logout" class="btn btn-outline-danger">
                            <i class="fas fa-sign-out-alt me-2"></i>Logout
                        </a>
                    </div>
                </div>

                <!-- Domain Analysis Section -->
                <div class="row">
                    <div class="col-lg-8">
                        <div class="card seo-card">
                            <div class="card-header seo-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-globe me-2"></i>Domain SEO Analysis
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-8">
                                        <label for="domain_input" class="form-label">Enter Domain to Analyze</label>
                                        <input type="text" class="form-control" id="domain_input" 
                                               placeholder="e.g., wetechforu.com or https://example.com">
                                    </div>
                                    <div class="col-md-4 d-flex align-items-end">
                                        <button type="button" class="btn btn-success w-100" onclick="analyzeDomain()">
                                            <i class="fas fa-search me-2"></i>Analyze Domain
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Analysis Results -->
                                <div id="analysis_results" class="mt-4" style="display: none;">
                                    <div class="domain-analysis">
                                        <h6><i class="fas fa-chart-line me-2"></i>Domain Analysis Results</h6>
                                        <div id="domain_authority" class="mb-3"></div>
                                        <div id="technical_seo" class="mb-3"></div>
                                        <div id="competitor_analysis" class="mb-3"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Backlink Strategy Section -->
                        <div class="card seo-card mt-4">
                            <div class="card-header seo-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-link me-2"></i>Backlink Strategy Generator
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="strategy_domain" class="form-label">Domain for Strategy</label>
                                        <input type="text" class="form-control" id="strategy_domain" 
                                               placeholder="e.g., wetechforu.com">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="industry_select" class="form-label">Industry</label>
                                        <select class="form-select" id="industry_select">
                                            <option value="healthcare">Healthcare</option>
                                            <option value="medical">Medical</option>
                                            <option value="dental">Dental</option>
                                            <option value="veterinary">Veterinary</option>
                                            <option value="fitness">Fitness</option>
                                            <option value="wellness">Wellness</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2 d-flex align-items-end">
                                        <button type="button" class="btn btn-primary w-100" onclick="generateStrategy()">
                                            <i class="fas fa-magic me-1"></i>Generate
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Strategy Results -->
                                <div id="strategy_results" class="mt-4" style="display: none;">
                                    <h6><i class="fas fa-road me-2"></i>Backlink Strategy</h6>
                                    <div id="strategy_phases"></div>
                                    <div id="strategy_tools"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="col-lg-4">
                        <!-- Backlink Opportunities -->
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-bullseye me-2"></i>Backlink Opportunities
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="backlink_opportunities">
                                    <p class="text-muted">Analyze a domain to see backlink opportunities</p>
                                </div>
                            </div>
                        </div>

                        <!-- SEO Recommendations -->
                        <div class="card mt-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-lightbulb me-2"></i>SEO Recommendations
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="seo_recommendations">
                                    <p class="text-muted">Analyze a domain to see SEO recommendations</p>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="card mt-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-bolt me-2"></i>Quick Actions
                                </h6>
                            </div>
                            <div class="card-body">
                                <button class="btn btn-outline-primary btn-sm w-100 mb-2" onclick="getDomainSuggestions()">
                                    <i class="fas fa-lightbulb me-1"></i>Get Domain Suggestions
                                </button>
                                <button class="btn btn-outline-success btn-sm w-100 mb-2" onclick="getSEOTools()">
                                    <i class="fas fa-tools me-1"></i>SEO Tools
                                </button>
                                <button class="btn btn-outline-info btn-sm w-100" onclick="exportReport()">
                                    <i class="fas fa-download me-1"></i>Export Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function analyzeDomain() {
            const domain = document.getElementById('domain_input').value.trim();
            if (!domain) {
                alert('Please enter a domain to analyze');
                return;
            }

            const analyzeBtn = document.querySelector('button[onclick="analyzeDomain()"]');
            const originalText = analyzeBtn.innerHTML;
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Analyzing...';
            analyzeBtn.disabled = true;

            fetch('/api/godaddy/domain-analysis', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ domain: domain })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    displayAnalysisResults(data.seo_analysis);
                    showNotification('✅ Domain analysis completed successfully!', 'success');
                } else {
                    showNotification('❌ Analysis failed: ' + data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('❌ An error occurred during analysis.', 'error');
            })
            .finally(() => {
                analyzeBtn.innerHTML = originalText;
                analyzeBtn.disabled = false;
            });
        }

        function displayAnalysisResults(analysis) {
            // Show results section
            document.getElementById('analysis_results').style.display = 'block';

            // Display domain authority
            const da = analysis.domain_authority;
            document.getElementById('domain_authority').innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <strong>Domain Authority:</strong> ${da.score}/100
                    </div>
                    <div class="col-md-6">
                        <small>${da.factors.join(', ')}</small>
                    </div>
                </div>
            `;

            // Display technical SEO
            const tech = analysis.technical_seo;
            document.getElementById('technical_seo').innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <strong>Technical SEO:</strong><br>
                        <small>SSL: ${tech.ssl_certificate ? '✅' : '❌'}</small><br>
                        <small>Mobile: ${tech.mobile_friendly ? '✅' : '❌'}</small><br>
                        <small>Speed: ${tech.page_speed}</small>
                    </div>
                    <div class="col-md-6">
                        <small>Meta Tags: ${tech.meta_tags}</small><br>
                        <small>Schema: ${tech.schema_markup}</small><br>
                        <small>Images: ${tech.image_optimization}</small>
                    </div>
                </div>
            `;

            // Display competitor analysis
            const competitors = analysis.competitor_analysis;
            document.getElementById('competitor_analysis').innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <strong>Top Competitors:</strong><br>
                        ${competitors.top_competitors.map(comp => 
                            `<small>${comp.domain} (DA: ${comp.domain_authority})</small><br>`
                        ).join('')}
                    </div>
                    <div class="col-md-6">
                        <strong>Keyword Gaps:</strong><br>
                        ${competitors.keyword_gaps.map(keyword => 
                            `<small>• ${keyword}</small><br>`
                        ).join('')}
                    </div>
                </div>
            `;

            // Display backlink opportunities
            displayBacklinkOpportunities(analysis.backlink_opportunities);

            // Display SEO recommendations
            displaySEORecommendations(analysis.seo_recommendations);
        }

        function displayBacklinkOpportunities(opportunities) {
            const container = document.getElementById('backlink_opportunities');
            container.innerHTML = '';

            opportunities.forEach(opp => {
                const difficultyClass = `difficulty-${opp.difficulty.toLowerCase()}`;
                const oppHtml = `
                    <div class="backlink-opportunity ${difficultyClass}">
                        <h6>${opp.type}</h6>
                        <p class="mb-2"><strong>Difficulty:</strong> ${opp.difficulty} | <strong>Value:</strong> ${opp.estimated_value}</p>
                        <div class="opportunities">
                            ${opp.opportunities.map(site => `<span class="badge bg-secondary me-1 mb-1">${site}</span>`).join('')}
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', oppHtml);
            });
        }

        function displaySEORecommendations(recommendations) {
            const container = document.getElementById('seo_recommendations');
            container.innerHTML = '';

            recommendations.forEach(rec => {
                const priorityClass = rec.priority === 'High' ? 'text-danger' : rec.priority === 'Medium' ? 'text-warning' : 'text-info';
                const recHtml = `
                    <div class="mb-3">
                        <h6 class="${priorityClass}">${rec.category} <span class="badge bg-${rec.priority === 'High' ? 'danger' : rec.priority === 'Medium' ? 'warning' : 'info'}">${rec.priority}</span></h6>
                        <ul class="small">
                            ${rec.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                        </ul>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', recHtml);
            });
        }

        function generateStrategy() {
            const domain = document.getElementById('strategy_domain').value.trim();
            const industry = document.getElementById('industry_select').value;

            if (!domain) {
                alert('Please enter a domain for strategy generation');
                return;
            }

            const generateBtn = document.querySelector('button[onclick="generateStrategy()"]');
            const originalText = generateBtn.innerHTML;
            generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Generating...';
            generateBtn.disabled = true;

            fetch('/api/godaddy/backlink-strategy', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ domain: domain, industry: industry })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    displayStrategyResults(data.strategy);
                    showNotification('✅ Backlink strategy generated successfully!', 'success');
                } else {
                    showNotification('❌ Strategy generation failed: ' + data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('❌ An error occurred during strategy generation.', 'error');
            })
            .finally(() => {
                generateBtn.innerHTML = originalText;
                generateBtn.disabled = false;
            });
        }

        function displayStrategyResults(strategy) {
            // Show results section
            document.getElementById('strategy_results').style.display = 'block';

            // Display strategy phases
            const phasesContainer = document.getElementById('strategy_phases');
            phasesContainer.innerHTML = '';

            strategy.phases.forEach(phase => {
                const phaseHtml = `
                    <div class="strategy-phase">
                        <h6>Phase ${phase.phase}: ${phase.name}</h6>
                        <p><strong>Duration:</strong> ${phase.duration} | <strong>Expected Results:</strong> ${phase.expected_results}</p>
                        <ul class="small">
                            ${phase.activities.map(activity => `<li>${activity}</li>`).join('')}
                        </ul>
                    </div>
                `;
                phasesContainer.insertAdjacentHTML('beforeend', phaseHtml);
            });

            // Display tools needed
            const toolsContainer = document.getElementById('strategy_tools');
            toolsContainer.innerHTML = `
                <div class="mt-3">
                    <h6><i class="fas fa-tools me-2"></i>Tools Needed</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <ul class="small">
                                ${strategy.tools_needed.map(tool => `<li>${tool}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Success Metrics</h6>
                            <ul class="small">
                                ${strategy.success_metrics.map(metric => `<li>${metric}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        function getDomainSuggestions() {
            const keyword = prompt('Enter a keyword for domain suggestions:');
            if (!keyword) return;

            fetch('/api/godaddy/domain-suggestions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ keyword: keyword })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showDomainSuggestionsModal(data.suggestions);
                } else {
                    showNotification('❌ Failed to get suggestions: ' + data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('❌ An error occurred while getting suggestions.', 'error');
            });
        }

        function showDomainSuggestionsModal(suggestions) {
            const modalHtml = `
                <div class="modal fade" id="domainSuggestionsModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-lightbulb me-2"></i>Domain Suggestions
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    ${suggestions.map(suggestion => `
                                        <div class="col-md-6 mb-3">
                                            <div class="card">
                                                <div class="card-body">
                                                    <h6>${suggestion.domain}</h6>
                                                    <p class="small text-muted">${suggestion.price ? '$' + suggestion.price : 'Price not available'}</p>
                                                    <button class="btn btn-sm btn-primary" onclick="useDomainSuggestion('${suggestion.domain}')">
                                                        Use This Domain
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Remove existing modal if any
            const existingModal = document.getElementById('domainSuggestionsModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Add modal to page
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // Show modal
            const modal = new bootstrap.Modal(document.getElementById('domainSuggestionsModal'));
            modal.show();
        }

        function useDomainSuggestion(domain) {
            document.getElementById('domain_input').value = domain;
            document.getElementById('strategy_domain').value = domain;

            // Close modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('domainSuggestionsModal'));
            modal.hide();

            showNotification('✅ Domain suggestion applied!', 'success');
        }

        function getSEOTools() {
            fetch('/api/godaddy/seo-tools')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        showSEOToolsModal(data.tools);
                    } else {
                        showNotification('❌ Failed to get SEO tools: ' + data.error, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showNotification('❌ An error occurred while getting SEO tools.', 'error');
                });
        }

        function showSEOToolsModal(tools) {
            const modalHtml = `
                <div class="modal fade" id="seoToolsModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-tools me-2"></i>SEO Tools & Integrations
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>GoDaddy SEO Tools</h6>
                                        <ul>
                                            ${tools.godaddy_seo_tools.map(tool => `<li>${tool}</li>`).join('')}
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>Third-Party Integrations</h6>
                                        <ul>
                                            ${tools.third_party_integrations.map(tool => `<li>${tool}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <h6>Recommended Workflow</h6>
                                    <ol>
                                        ${tools.recommended_workflow.map(step => `<li>${step}</li>`).join('')}
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Remove existing modal if any
            const existingModal = document.getElementById('seoToolsModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Add modal to page
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // Show modal
            const modal = new bootstrap.Modal(document.getElementById('seoToolsModal'));
            modal.show();
        }

        function exportReport() {
            // This would export the current analysis results
            showNotification('📄 Export functionality coming soon!', 'info');
        }

        function showNotification(message, type) {
            const alertClass = type === 'success' ? 'alert-success' : type === 'error' ? 'alert-danger' : 'alert-info';
            const notificationHtml = `
                <div class="alert ${alertClass} alert-dismissible fade show position-fixed" 
                     style="top: 20px; right: 20px; z-index: 9999; min-width: 300px;">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', notificationHtml);

            // Auto-remove after 5 seconds
            setTimeout(() => {
                const alert = document.querySelector('.alert:last-of-type');
                if (alert) {
                    alert.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>
